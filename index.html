<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalino v2 — فروشگاه</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --white:#ffffff;
    --muted:#f4f6f8;
    --surface:#f1f3f5;
    --text:#111214;
    --sub:#69707a;
    --accent:#ff5a5f; /* kept for small accents if needed */
    --green:#41b883;
    --shadow: 0 6px 18px rgba(16,24,40,0.06);
    --glass: rgba(255,255,255,0.6);
  }
  /* Reset */
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family:'Vazirmatn',sans-serif;
    background:var(--white);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    direction:rtl;
    padding-bottom:88px; /* for bottom nav */
  }

  /* Header */
  header{
    position:sticky;top:0;z-index:40;
    display:flex;align-items:center;justify-content:center;
    padding:12px 16px;background:linear-gradient(180deg,#ffffff, #fbfdff 60%);
    border-bottom:1px solid #eef1f4;
    backdrop-filter: blur(6px);
  }
  header .left {
    position:absolute; left:12px; top:8px; display:flex; gap:8px; align-items:center;
  }
  .brand{font-weight:700;font-size:18px}
  .icon-btn{
    width:44px;height:44px;border-radius:12px;background:var(--muted);
    display:inline-flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid #e8edf1;
    transition:transform .12s ease;
  }
  .icon-btn:active{transform:scale(.98)}

  /* Search */
  .search-wrap{padding:12px 16px}
  .search{
    width:100%;display:flex;align-items:center;gap:10px;
    background:var(--surface);padding:10px;border-radius:12px;box-shadow:var(--shadow);
  }
  .search input{
    flex:1;border:0;background:transparent;outline:none;font-size:15px;color:var(--text);
  }
  .search input::placeholder{color:var(--sub);opacity:0.9}
  .search .btn{
    padding:8px 10px;border-radius:10px;border:0;background:var(--white);box-shadow:0 2px 8px rgba(0,0,0,.06);
    cursor:pointer;font-weight:600;font-size:14px;
  }

  main{padding:6px 16px 120px}
  h2.section-title{font-size:16px;margin-bottom:12px;font-weight:700}

  /* Categories */
  .categories{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
  .cat-card{
    background:var(--muted);padding:10px;border-radius:12px;text-align:center;cursor:pointer;
    transition:transform .14s ease,box-shadow .14s ease;
  }
  .cat-card:hover{transform:translateY(-4px);box-shadow:0 8px 20px rgba(16,24,40,0.06)}
  .cat-card .emoji{font-size:20px;margin-bottom:6px}

  /* Carousel / products */
  .carousel{display:flex;gap:12px;overflow-x:auto;padding-bottom:6px}
  .carousel::-webkit-scrollbar{height:8px}
  .prod-card{
    min-width:172px;background:var(--white);border-radius:12px;padding:10px;flex-shrink:0;
    box-shadow:var(--shadow);display:flex;flex-direction:column;gap:8px;
  }
  .prod-card img{width:100%;height:110px;object-fit:cover;border-radius:8px}
  .prod-card .title{font-weight:600;font-size:14px}
  .prod-card .price{color:var(--green);font-weight:600}
  .prod-card .actions{display:flex;gap:8px;align-items:center;margin-top:auto}
  .btn-primary{
    flex:1;padding:8px;border-radius:10px;border:0;background:var(--green);color:#fff;cursor:pointer;font-weight:600;
  }
  .btn-outline{padding:8px;border-radius:10px;border:1px solid #e6eaee;background:transparent;cursor:pointer}

  /* Pages */
  .page{display:none}
  .page.active{display:block}

  /* Cart list */
  .cart-list{display:flex;flex-direction:column;gap:10px}
  .cart-item{
    display:flex;gap:12px;align-items:center;background:var(--muted);padding:10px;border-radius:12px;
  }
  .cart-item img{width:72px;height:72px;border-radius:8px;object-fit:cover}
  .cart-item-info{flex:1;display:flex;flex-direction:column;gap:6px}
  .cart-item-title{font-weight:700}
  .cart-item-price{color:var(--green);font-weight:600}
  .qty-controls{display:flex;align-items:center;gap:8px}
  .qty-controls button{width:34px;height:34px;border-radius:8px;border:0;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.06);cursor:pointer}
  .remove-btn{background:transparent;border:0;color:var(--accent);font-size:18px;cursor:pointer}

  .cart-footer{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:12px;margin-top:8px;background:linear-gradient(180deg,#fff,#fbfdff)}
  .total{font-weight:700;font-size:16px}
  .checkout{padding:10px 14px;border-radius:12px;background:var(--green);color:#fff;border:0;cursor:pointer;font-weight:700}

  /* Account page */
  .account-card{background:var(--muted);padding:12px;border-radius:12px;display:flex;flex-direction:column;gap:10px}
  .account-row{display:flex;justify-content:space-between;align-items:center}
  .small-btn{padding:8px 10px;border-radius:10px;border:0;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06);cursor:pointer}
  .orders-list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
  .order-item{background:#fff;padding:10px;border-radius:10px;box-shadow:var(--shadow);font-size:14px}

  /* Toast */
  .toast{
    position:fixed;left:50%;transform:translateX(-50%);bottom:92px;background:rgba(20,20,20,.9);
    color:#fff;padding:10px 14px;border-radius:10px;font-weight:600;z-index:60;opacity:0;pointer-events:none;
    transition:opacity .18s ease,transform .18s ease;
  }
  .toast.show{opacity:1;transform:translateX(-50%) translateY(-6px);pointer-events:auto}

  /* Bottom nav */
  .bottom-nav{
    position:fixed;left:0;right:0;bottom:0;height:72px;background:var(--white);
    display:flex;justify-content:space-around;align-items:center;border-top:1px solid #eef1f4;z-index:50;
  }
  .bottom-btn{display:flex;flex-direction:column;align-items:center;gap:4px;color:var(--sub);cursor:pointer;font-size:12px}
  .bottom-btn.active{color:var(--green);font-weight:700}

  /* Responsive */
  @media (min-width:720px){
    main{max-width:900px;margin:0 auto}
    .categories{grid-template-columns:repeat(6,1fr)}
  }
  @media (max-width:420px){
    .categories{grid-template-columns:repeat(3,1fr)}
    .prod-card{min-width:150px}
  }
</style>
</head>
<body>

<header>
  <div class="left">
    <div class="icon-btn" id="userBtn" title="حساب کاربری">👤</div>
  </div>
  <div class="brand">Kalino</div>
</header>

<div class="search-wrap">
  <div class="search" role="search">
    <input id="searchInput" placeholder="چی لازم داری؟ جستجو کن..." aria-label="جستجو محصولات" />
    <button class="btn btn-primary" id="clearSearch" title="پاک کردن">×</button>
    <button class="btn btn-outline" id="doSearch" title="جستجو">جستجو</button>
  </div>
</div>

<main>
  <!-- HOME PAGE -->
  <section class="page active" id="homePage">
    <div style="margin-bottom:14px">
      <h2 class="section-title">دسته‌بندی‌ها</h2>
      <div class="categories" id="categoriesList"></div>
    </div>

    <div style="margin-bottom:14px">
      <h2 class="section-title">پیشنهادها برای شما</h2>
      <div class="carousel" id="productsCarousel"></div>
    </div>

    <div>
      <h2 class="section-title">تخفیفات ویژه</h2>
      <div class="carousel" id="promoCarousel"></div>
    </div>
  </section>

  <!-- CART PAGE -->
  <section class="page" id="cartPage">
    <h2 class="section-title">سبد خرید</h2>
    <div id="cartContent">
      <div class="cart-list" id="cartItems"></div>
      <div class="cart-footer" id="cartFooter" style="display:none">
        <div>
          <div style="font-size:13px;color:var(--sub)">جمع کل</div>
          <div class="total" id="cartTotal">۰ تومان</div>
        </div>
        <div>
          <button class="checkout" id="checkoutBtn">ثبت سفارش</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ACCOUNT PAGE -->
  <section class="page" id="accountPage">
    <h2 class="section-title">حساب کاربری</h2>
    <div class="account-card">
      <div style="display:flex;gap:12px;align-items:center">
        <div style="width:64px;height:64px;border-radius:12px;background:var(--muted);display:flex;align-items:center;justify-content:center;font-size:28px">👤</div>
        <div style="flex:1">
          <div id="acctName" style="font-weight:700">نام کاربر</div>
          <div id="acctPhone" style="color:var(--sub);margin-top:4px">۰۹۰۰۰۰۰۰۰۰</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button class="small-btn" id="editProfileBtn">ویرایش</button>
          <button class="small-btn" id="logoutBtn">خروج</button>
        </div>
      </div>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
        <div>
          <div style="font-size:13px;color:var(--sub)">کیف پول</div>
          <div id="walletAmount" style="font-weight:700">۰ تومان</div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <input id="topupValue" type="number" min="1000" placeholder="مبلغ (تومان)" style="padding:8px;border-radius:10px;border:1px solid #e6eaee;background:#fff" />
          <button class="small-btn" id="topupBtn">افزایش</button>
        </div>
      </div>

      <div style="margin-top:8px">
        <div style="font-weight:700;margin-bottom:8px">تاریخچه سفارش‌ها</div>
        <div class="orders-list" id="ordersList">
          <div style="color:var(--sub)">هیچ سفارشی وجود ندارد.</div>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- Bottom nav -->
<nav class="bottom-nav" role="navigation" aria-label="ناوبری پایین">
  <div class="bottom-btn active" data-page="homePage">🏠<div>خانه</div></div>
  <div class="bottom-btn" data-page="cartPage">🛒<div>سبد خرید <span id="cartBadge" style="font-size:11px;margin-right:6px;color:var(--green)"></span></div></div>
  <div class="bottom-btn" data-page="accountPage">👤<div>حساب</div></div>
</nav>

<!-- Toast -->
<div id="toast" class="toast" role="status" aria-live="polite"></div>

<script>
  // ---------- داده اولیه ----------
  const categories = [
    { title: 'دستمال و شوینده', emoji: '🧼' },
    { title: 'لبنیات', emoji: '🥛' },
    { title: 'خوار و بار', emoji: '🛒' },
    { title: 'آرایش و بهداشتی', emoji: '💄' },
    { title: 'نوشیدنی', emoji: '🥤' },
    { title: 'تنقلات', emoji: '🍫' },
    { title: 'صبحانه', emoji: '🥐' },
    { title: 'کنسرو', emoji: '🥫' },
  ];

  const products = [
    { id: 'p1', name: 'چیپس نمکی', price: 20000, img: 'https://via.placeholder.com/400x300?text=چیپس' },
    { id: 'p2', name: 'شیر کم چرب 1L', price: 15000, img: 'https://via.placeholder.com/400x300?text=شیر' },
    { id: 'p3', name: 'کنسرو لوبیا', price: 12000, img: 'https://via.placeholder.com/400x300?text=کنسرو' },
    { id: 'p4', name: 'کالباس ویژه', price: 45000, img: 'https://via.placeholder.com/400x300?text=کالباس' },
    { id: 'p5', name: 'نوشابه قوطی', price: 8000, img: 'https://via.placeholder.com/400x300?text=نوشابه' },
    { id: 'p6', name: 'کیک صبحانه', price: 22000, img: 'https://via.placeholder.com/400x300?text=کیک' },
  ];

  // ---------- حالت و ذخیره محلی ----------
  const LS_CART = 'kalino_cart_v2';
  const LS_USER = 'kalino_user_v2';
  const LS_ORDERS = 'kalino_orders_v2';

  let cart = JSON.parse(localStorage.getItem(LS_CART) || '[]');
  let user = JSON.parse(localStorage.getItem(LS_USER) || '{}');
  let orders = JSON.parse(localStorage.getItem(LS_ORDERS) || '[]');

  // ---------- کمک‌کننده‌ها ----------
  function formatToman(n){
    // n integer
    return n.toLocaleString('fa-IR') + ' تومان';
  }

  function toast(msg, time=1800){
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(t._hide);
    t._hide = setTimeout(()=> t.classList.remove('show'), time);
  }

  function saveCart(){ localStorage.setItem(LS_CART, JSON.stringify(cart)) }
  function saveUser(){ localStorage.setItem(LS_USER, JSON.stringify(user)) }
  function saveOrders(){ localStorage.setItem(LS_ORDERS, JSON.stringify(orders)) }

  // ---------- رندر دسته‌بندی و محصولات ----------
  const categoriesList = document.getElementById('categoriesList');
  categories.forEach(c=>{
    const d = document.createElement('div');
    d.className = 'cat-card';
    d.tabIndex = 0;
    d.innerHTML = `<div class="emoji">${c.emoji}</div><div style="font-weight:600">${c.title}</div>`;
    categoriesList.appendChild(d);
    // می‌توان اضافه کرد که فیلتر کند
  });

  const productsCarousel = document.getElementById('productsCarousel');
  function renderProducts(list){
    productsCarousel.innerHTML = '';
    list.forEach(p=>{
      const card = document.createElement('div');
      card.className = 'prod-card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}">
        <div class="title">${p.name}</div>
        <div class="price">${formatToman(p.price)}</div>
        <div class="actions">
          <button class="btn-outline" data-action="details" data-id="${p.id}">جزئیات</button>
          <button class="btn-primary" data-action="add" data-id="${p.id}">افزودن</button>
        </div>
      `;
      productsCarousel.appendChild(card);
    });
  }
  renderProducts(products);

  // ---------- نوار جستجو ----------
  const searchInput = document.getElementById('searchInput');
  const doSearch = document.getElementById('doSearch');
  const clearSearch = document.getElementById('clearSearch');

  function applySearch(){
    const q = searchInput.value.trim().toLowerCase();
    if(!q){ renderProducts(products); toast('نمایش همهٔ محصولات'); return; }
    const res = products.filter(p => p.name.includes(q));
    renderProducts(res);
    toast(`${res.length} نتیجه برای "${searchInput.value}"`);
  }
  doSearch.addEventListener('click', applySearch);
  searchInput.addEventListener('keydown', e => { if(e.key === 'Enter') applySearch() });
  clearSearch.addEventListener('click', ()=>{ searchInput.value=''; renderProducts(products); });

  // ---------- مدیریت سبد خرید ----------
  const cartItemsContainer = document.getElementById('cartItems');
  const cartTotalSpan = document.getElementById('cartTotal');
  const cartFooter = document.getElementById('cartFooter');
  const cartBadge = document.getElementById('cartBadge');

  function calcCartTotals(){
    let total = 0;
    let count = 0;
    for(const it of cart){
      // careful arithmetic: compute price * quantity explicitly
      const line = Number(it.price) * Number(it.quantity);
      total += line;
      count += Number(it.quantity);
    }
    return { total, count };
  }

  function updateCartUI(){
    cartItemsContainer.innerHTML = '';
    if(cart.length === 0){
      cartItemsContainer.innerHTML = `<div style="color:var(--sub)">سبد خرید خالی است.</div>`;
      cartFooter.style.display = 'none';
      cartBadge.textContent = '';
      return;
    }
    cartFooter.style.display = 'flex';
    const { total, count } = calcCartTotals();
    cartTotalSpan.textContent = formatToman(total);
    cartBadge.textContent = count > 0 ? `(${count})` : '';

    cart.forEach((item, idx) => {
      const div = document.createElement('div');
      div.className = 'cart-item';
      div.innerHTML = `
        <img src="${item.img}" alt="${item.name}">
        <div class="cart-item-info">
          <div class="cart-item-title">${item.name}</div>
          <div class="cart-item-price">${formatToman(item.price)} × ${item.quantity} = ${formatToman(item.price * item.quantity)}</div>
          <div class="qty-controls" data-idx="${idx}">
            <button data-op="minus" title="کم کردن">−</button>
            <div style="min-width:36px;text-align:center;font-weight:700">${item.quantity}</div>
            <button data-op="plus" title="افزایش">+</button>
            <button style="margin-left:8px" class="remove-btn" data-op="remove" title="حذف">حذف</button>
          </div>
        </div>
      `;
      cartItemsContainer.appendChild(div);
    });
    saveCart();
  }

  // delegation for qty controls
  cartItemsContainer.addEventListener('click', (e)=>{
    const btn = e.target.closest('button');
    if(!btn) return;
    const parent = e.target.closest('.qty-controls');
    if(!parent) return;
    const idx = Number(parent.dataset.idx);
    const op = btn.dataset.op;
    if(isNaN(idx) || !cart[idx]) return;

    if(op === 'plus'){
      cart[idx].quantity = Number(cart[idx].quantity) + 1;
      toast('تعداد افزایش یافت');
    } else if(op === 'minus'){
      cart[idx].quantity = Number(cart[idx].quantity) - 1;
      if(cart[idx].quantity <= 0){
        cart.splice(idx,1);
        toast('محصول از سبد حذف شد');
      } else {
        toast('تعداد کاهش یافت');
      }
    } else if(op === 'remove'){
      cart.splice(idx,1);
      toast('محصول حذف شد');
    }
    updateCartUI();
  });

  // ---------- افزودن محصول به سبد (از محصولات) ----------
  productsCarousel.addEventListener('click', (e)=>{
    const btn = e.target.closest('button');
    if(!btn) return;
    const action = btn.dataset.action;
    const id = btn.dataset.id;
    const product = products.find(p => p.id === id);
    if(!product) return;

    if(action === 'add'){
      const existing = cart.find(it => it.id === product.id);
      if(existing){ existing.quantity = Number(existing.quantity) + 1; }
      else { cart.push({...product, quantity:1}); }
      toast(`"${product.name}" به سبد اضافه شد`);
      updateCartUI();
    } else if(action === 'details'){
      toast(`${product.name} — ${formatToman(product.price)}`);
    }
  });

  // ---------- checkout: ذخیره سفارش و پاک کردن سبد ----------
  const checkoutBtn = document.getElementById('checkoutBtn');
  checkoutBtn.addEventListener('click', ()=>{
    if(cart.length === 0){ toast('سبد خرید شما خالی است'); return; }
    // subtract wallet if user wants? here: just record order
    const { total } = calcCartTotals();
    const order = {
      id: 'order_' + Date.now(),
      items: JSON.parse(JSON.stringify(cart)),
      total,
      createdAt: new Date().toISOString()
    };
    orders.unshift(order);
    saveOrders();
    cart = [];
    saveCart();
    updateCartUI();
    renderOrders();
    toast('سفارش ثبت شد. ممنون از خرید شما!');
    showPage('homePage');
  });

  // ---------- حساب کاربری ----------
  const acctName = document.getElementById('acctName');
  const acctPhone = document.getElementById('acctPhone');
  const walletAmount = document.getElementById('walletAmount');
  const ordersList = document.getElementById('ordersList');
  const editProfileBtn = document.getElementById('editProfileBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const topupBtn = document.getElementById('topupBtn');
  const topupValue = document.getElementById('topupValue');

  function ensureUser(){
    if(!user.name) user = { name: 'کاربر مهمان', phone: '۰۹۰۰۰۰۰۰۰۰', wallet: 0 };
    saveUser();
  }
  ensureUser();

  function renderAccount(){
    acctName.textContent = user.name || 'نام کاربر';
    acctPhone.textContent = user.phone || '۰۹۰۰۰۰۰۰۰';
    walletAmount.textContent = formatToman(Number(user.wallet || 0));
  }
  renderAccount();

  function renderOrders(){
    ordersList.innerHTML = '';
    if(orders.length === 0){
      ordersList.innerHTML = '<div style="color:var(--sub)">هیچ سفارشی وجود ندارد.</div>';
      return;
    }
    orders.forEach(o=>{
      const d = document.createElement('div');
      d.className = 'order-item';
      const date = new Date(o.createdAt);
      const itemsSummary = o.items.map(it => `${it.name} × ${it.quantity}`).join('، ');
      d.innerHTML = `<div style="font-weight:700">#${o.id.split('_')[1]}</div>
                     <div style="color:var(--sub);font-size:13px;margin-top:6px">${itemsSummary}</div>
                     <div style="display:flex;justify-content:space-between;margin-top:8px">
                       <div style="font-weight:700">${formatToman(o.total)}</div>
                       <div style="color:var(--sub);font-size:13px">${date.toLocaleString('fa-IR')}</div>
                     </div>`;
      ordersList.appendChild(d);
    });
  }
  renderOrders();

  editProfileBtn.addEventListener('click', ()=>{
    // ساده: prompt برای نام و شماره (می‌تونیم modal زیباتر بسازیم)
    const newName = prompt('نام و نام خانوادگی را وارد کنید:', user.name || '');
    if(newName === null) return;
    const newPhone = prompt('شماره تلفن را وارد کنید:', user.phone || '');
    if(newPhone === null) return;
    user.name = newName.trim() || user.name;
    user.phone = newPhone.trim() || user.phone;
    saveUser();
    renderAccount();
    toast('اطلاعات حساب بروزرسانی شد');
  });

  logoutBtn.addEventListener('click', ()=>{
    if(confirm('آیا از خروج مطمئنید؟')) {
      user = { name:'کاربر مهمان', phone:'۰۹۰۰۰۰۰۰۰۰', wallet:0 };
      saveUser();
      renderAccount();
      toast('شما خارج شدید');
    }
  });

  topupBtn.addEventListener('click', ()=>{
    const v = Number(topupValue.value);
    if(!v || v < 1000){ toast('مبلغ معتبر وارد کنید (حداقل ۱۰۰۰ تومان)'); return; }
    user.wallet = Number(user.wallet || 0) + v;
    saveUser();
    renderAccount();
    topupValue.value = '';
    toast('کیف پول با موفقیت شارژ شد');
  });

  // ---------- صفحات و ناوبری ----------
  const pages = document.querySelectorAll('.page');
  const navBtns = document.querySelectorAll('.bottom-btn');

  function showPage(id){
    pages.forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    navBtns.forEach(b => b.classList.remove('active'));
    document.querySelector(`.bottom-btn[data-page='${id}']`)?.classList.add('active');
  }

  navBtns.forEach(b => b.addEventListener('click', ()=> showPage(b.dataset.page)));

  // user icon on header opens account page
  document.getElementById('userBtn').addEventListener('click', ()=> {
    showPage('accountPage');
    toast('صفحه حساب باز شد');
  });

  // ---------- مقدار اولیه UI ----------
  updateCartUI();
  renderAccount();

  // ---------- کمک: نمایش ساده محصول در ساید promo ----------
  const promoCarousel = document.getElementById('promoCarousel');
  const promos = products.slice(0,3);
  promos.forEach(p=>{
    const el = document.createElement('div');
    el.className = 'prod-card';
    el.style.minWidth='220px';
    el.innerHTML = `<img src="${p.img}" alt="${p.name}">
      <div class="title">${p.name}</div>
      <div class="price">${formatToman(p.price)}</div>
      <div style="display:flex;justify-content:flex-end;margin-top:auto"><button class="btn-primary" data-id="${p.id}" data-action="add">اضافه</button></div>`;
    promoCarousel.appendChild(el);
  });

  // add from promos to cart (delegation)
  promoCarousel.addEventListener('click', (e)=>{
    const b = e.target.closest('button');
    if(!b) return;
    const id = b.dataset.id;
    const product = products.find(x => x.id === id);
    if(!product) return;
    const ex = cart.find(it=>it.id===product.id);
    if(ex) ex.quantity = Number(ex.quantity) + 1;
    else cart.push({...product, quantity:1});
    updateCartUI();
    toast('به سبد اضافه شد');
  });

  // ---------- نگهداری آگاهانه از localStorage: save on unload ----------
  window.addEventListener('beforeunload', ()=>{
    saveCart(); saveUser(); saveOrders();
  });

  // ---------- پشتیبانی از راست‌به‌چپ و خوانایی اعداد فارسی ----------
  // (اختیاری) اگر خواستی، می‌توان اعداد را فارسی کرد — فعلاً از toLocaleString('fa-IR') استفاده شده

</script>
</body>
</html>
